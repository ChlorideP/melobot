# 事件预处理

## 预处理时机

事件预处理在事件处理过程前发生。预处理可能会得到一些中间结果，这些中间结果在事件处理过程中可用。

预处理的结果，将会决定是否可以继续运行后续的事件处理过程。预处理失败，不会再进行事件处理；反之则可以运行事件处理。

每一个事件处理方法，都会有**一个独立的预处理过程**。即使用户不自行指定预处理规则，事件绑定方法也会为事件处理方法**自动应用默认的预处理规则**。

只有消息事件、请求事件、通知事件、元事件有预处理过程。响应事件没有预处理过程。

## 预处理流程

对于消息事件，它的预处理环节有两个，按顺序分别是：`匹配或解析`、`校验`。

- `匹配`：对消息中的纯文本内容进行匹配
- `解析`：对消息中的纯文本内容进行参数解析
- `校验`：对消息事件进行校验

```{admonition} 相关知识
:class: note
匹配、解析都在预处理的第一环节。一个消息事件处理方法，只能应用其中一种。

任一环节没有规则，此环节直接通过。但任一环节不通过，预处理直接失败。所有环节通过，预处理才通过。
```

除响应事件、消息事件外的其他事件类型，预处理环节有且只有一个：`校验`。

- `校验`：对事件进行校验

```{admonition} 相关知识
:class: note
任一环节没有规则，此环节直接通过。但任一环节不通过，预处理直接失败。所有环节通过，预处理才通过。
```
